Data files required for analysis are provided in Data folder and referenced from R scripts in Code/...

Fig. 3 a/b/h, Supp Fig. 7 b
- RNASeq reads from mouse organoids were quantified by Salmon using Gencode M12 transcript sequences (Code/RNA/gene_counts/quantify_reads_batch_1.sh and ../quantify_reads_batch_2.sh)
- Differential gene expression was calculated separately for both botaches according to scripts Code/RNASeq/DGE/batch_1/DGE-analysis.Rmd and Code/RNASeq/DGE/batch_2/DGE-analysis.Rmd
- GSEA was run on DGE results using script Code/RNA/DGE/all_samples/GSEA_Analysis.Rmd. 
- Figures were generated using scripts Code/RNA/DGE/all_samples/GSEA_combined.Rmd and Code/RNA/DGE/all_samples/Visualizations.Rmd and store in Results/RNASeq [ log2FC_avg_WI_vs_NI_Lgr5_SC_Signature_Munoz.pdf, Heatmap_FC_vs_NI_all.pdf, HALLMARK_Heatmap.pdf,  ]

Fig 4 a/b/c/d, Supp Fig. 6c,d
- DNASeq reads from mouse organoids were aligned to GRCh37 by BWA-MEM (Code/DNA_WGS/mapping/align_BWA_MEM.sh). For CNV analysis all lanes were merged (Code/DNA/mapping/merge_BAMs.sh )
- Aligned reads were processed by Picard and GATK including Duplicate marking and realignment around indels (Code/DNA_WGS/GATK/SCRIPT_run_GATK)
- SNV and InDels were called using Strelka v1 on individual samples (Code/DNA_WGS/Strelka/run_Strelka.sh)
- CNV were called using ControlFreeC (Code/DNA_WGS/CNV_ControlFreeC/SCRIPT_Mm_single)
- SNV/Indel calls for individual samples were filtered and imported (Code/DNA_WGS/Strelka/filter_strelka_calls_by_SWI_germline.sh and import_variants.R)
- Overview figure for SNV/Indel (Fig. 4a) was generated using Code/DNA_WGS/All_mutations/OverviewCounts/Overview_counts_v2.Rmd
- Genes in different pathways affected by CNV and SNV were determined using script Code/DNA_WGS/All_mutations/MutatedGenes/ComprehensiveGeneAnalysis_WGS_reseq_recalled_CNV_clonal_only.Rmd (Fig. 4c)
- Circos plots were generated by script Code/DNA_WGS/All_mutations/Circos/Circos_WGS_v1b_2020-09.R (Fig. 4b).
- Oncomaps showing mutations in specific genes (Fig.4d, Supp Fig. 6c/d) were generated by script Code/DNA_WGS/All_mutations/MutatedGenes/Oncoprint_clonal_only.Rmd
- All results files are in Results/DNASeq_WGS

Supp Fig. 6a-b
- DNASeq reads from mouse organoids were aligned to GRCh37 by BWA-MEM (Code/DNA/mapping/align_BWA_MEM_mouse{2,3}.sh). For CNV analysis all lanes were merged (Code/DNA/mapping/MERGE_BAMS_SCRIPT_mouse{2,3} )
- Aligned reads were processed by Picard and GATK including Duplicate marking and realignment around indels (Code/DNA/GATK/Mouse{2,3}/SCRIPT_run_GATK)
- Duplicate reads were removed for SNV/Indel calling with Strelka (Code/DNA/Dedup/DeDup.sh). In addition, to increase the sensitivity, individual clones and pooled samples from the same mouse and condition were pooled (Code/DNA/Dedup/merge_WI_NI.sh)
- SNV and InDels were called using Strelka v1 on individual samples (Code/DNA/SNV_Strelka/run_Strelka.sh) and aggregated samples (Code/DNA/SNV_Strelka_aggregated/run_Strelka.sh)
- CNV were called using CONTRA (Code/DNA/CNV_Contra/Mouse{2,3}/pipeline.sh)
- SNV/Indel calls for individual samples were filtered and imported (Code/DNA/SNV_Strelka/filter_strelka_calls_by_SWI_germline.sh and import_variants.R)
- SNV/Indel calls for aggregated samples were filtered and imported (Code/DNA/SNV_Strelka_aggregated/filter_strelka_calls_by_SWI_germline.sh and import_variants.R)
- Genes in different pathways affected by CNV and SNV were determined using script Code/DNA/MutatedGenes/ComprehensiveGeneAnalysis.Rmd
- Circos plots were generated by script Code/DNA/Circos/Circos_v5 (Supp Fig. 6a).
- All results files are in Results/DNASeq


